srun: job 34137 queued and waiting for resources
srun: job 34137 has been allocated resources
Namespace(device='cuda', dataset='tissue', data_dir='./data', noise_type='symmetric', noise_rate=20, num_classes=8, batch_size=128, num_batches=10000, clustering='none', num_samples=165466, model='resnet18', pretrain=False, optimizer='sgd', momentum=0.9, lr=0.05, epochs=10, gamma=0.01, weight_decay=0.0)
Using downloaded and verified file: /u/home/tei/.medmnist/tissuemnist_128.npz
Actual Noise Rate:  0.19915873955978872
Using downloaded and verified file: /u/home/tei/.medmnist/tissuemnist_128.npz
Train set length:  165466
Test set length:  47280
Using ResNet18
Initializing  model resnet18
Using SGD. LR: 0.05, WD: 0.0, M: 0.9
Using CosineAnnealingLR. T_max 10, ETA: 0.0005
Current sieving threshold is 0.1
Start eval
/u/home/tei/.conda/envs/coenv/lib/python3.9/site-packages/torch/nn/modules/conv.py:456: UserWarning: Attempt to open cnn_infer failed: handle=0 error: libcudnn_cnn_infer.so.8: cannot open shared object file: No such file or directory (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:81.)
  return F.conv2d(input, weight, bias, self.stride,
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 58435/76729  76.15764574020253%
Noisy Selection success: 14660/88737  16.520729797040694%
Counts of filtered labels
Counter({0: 39096, 3: 13752, 7: 12643, 4: 8866, 6: 6748, 5: 4854, 1: 1819, 2: 959})
Epoch : 0
Epoch # 0
Start train
End train
Training loss: 1.4189304341111917, Training accuracy: 0.5087449989725986 
Start test
Average test loss(weighted):  6.4173, test accuracy:  24.0376
Class-wise accuracies:
 [0.014836795628070831, 0.5087326169013977, 0.892665445804596, 0.0, 0.011576135642826557, 0.0, 0.6355682611465454, 0.19186459481716156, 0.24037648737430573]
Class-wise F1 scores:
 [0.029032258316874504, 0.15007595717906952, 0.16864755749702454, 0.0, 0.022595597431063652, 0.0, 0.5505800247192383, 0.2631681561470032, 0.24037648737430573]
Class-wise AUCs:
 [0.5704452991485596, 0.6931360960006714, 0.863029956817627, 0.2971576750278473, 0.3592108190059662, 0.4199555218219757, 0.797238826751709, 0.688957929611206, 0.6104657649993896]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 32867/36765  89.39752481980145%
Noisy Selection success: 29056/128701  22.5763591580485%
Counts of filtered labels
Counter({0: 50675, 7: 19871, 6: 18509, 3: 14950, 4: 11334, 5: 7474, 1: 4302, 2: 1586})
Epoch : 1
Epoch # 1
Start train
End train
Training loss: 0.10508428136936958, Training accuracy: 0.9620647142011047 
Start test
Average test loss(weighted):  13.4802, test accuracy:  30.1206
Class-wise accuracies:
 [0.06732607632875443, 0.41513657569885254, 0.9081693291664124, 0.0, 0.031463343650102615, 0.0, 0.791804313659668, 0.2552979588508606, 0.301205575466156]
Class-wise F1 scores:
 [0.12282706797122955, 0.1671927124261856, 0.19309033453464508, 0.0, 0.05935050547122955, 0.0, 0.5938200950622559, 0.3256531059741974, 0.301205575466156]
Class-wise AUCs:
 [0.655815601348877, 0.7211496233940125, 0.8805732131004333, 0.3669041395187378, 0.48528140783309937, 0.47134190797805786, 0.8440159559249878, 0.7302356958389282, 0.6748841404914856]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 41620/45520  91.4323374340949%
Noisy Selection success: 29054/119946  24.22256682173645%
Counts of filtered labels
Counter({0: 48324, 7: 18534, 3: 14936, 6: 13499, 4: 11209, 5: 7455, 1: 4476, 2: 1513})
Epoch : 2
Epoch # 2
Start train
End train
Training loss: 0.06855250755829156, Training accuracy: 0.9751610602782445 
Start test
Average test loss(weighted):  13.5426, test accuracy:  31.5799
Class-wise accuracies:
 [0.11071546375751495, 0.38065382838249207, 0.9242695569992065, 0.0, 0.05491243675351143, 0.0, 0.8295688033103943, 0.19556251168251038, 0.3157995045185089]
Class-wise F1 scores:
 [0.19109947979450226, 0.1773049682378769, 0.18990443646907806, 0.0, 0.09796134382486343, 0.0, 0.600335955619812, 0.28236985206604004, 0.3157995045185089]
Class-wise AUCs:
 [0.7175800204277039, 0.7224897742271423, 0.8871686458587646, 0.36325883865356445, 0.48268118500709534, 0.45860713720321655, 0.857210636138916, 0.7313427925109863, 0.6971650123596191]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 44448/48405  91.82522466687327%
Noisy Selection success: 28997/117061  24.77084596919555%
Counts of filtered labels
Counter({0: 46291, 7: 19079, 3: 14920, 6: 12342, 4: 10940, 5: 7454, 1: 4606, 2: 1429})
Epoch : 3
Epoch # 3
Start train
End train
Training loss: 0.04788937769268048, Training accuracy: 0.9829632673781925 
Start test
Average test loss(weighted):  11.8430, test accuracy:  35.0931
Class-wise accuracies:
 [0.1764589548110962, 0.3690102994441986, 0.9087656736373901, 0.0, 0.06173938885331154, 0.0, 0.8613516688346863, 0.24349309504032135, 0.3509306311607361]
Class-wise F1 scores:
 [0.2857295274734497, 0.1825634241104126, 0.2200721949338913, 0.0, 0.10910044610500336, 0.0, 0.5982514023780823, 0.3330415189266205, 0.3509306311607361]
Class-wise AUCs:
 [0.7746289372444153, 0.7245676517486572, 0.9030615091323853, 0.4019409716129303, 0.5703744888305664, 0.49923714995384216, 0.8651360273361206, 0.7545886039733887, 0.7332021594047546]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 49380/53391  92.4874978929033%
Noisy Selection success: 28943/112075  25.824670979254964%
Counts of filtered labels
Counter({0: 43323, 7: 18305, 3: 14903, 6: 11314, 4: 10834, 5: 7445, 1: 4526, 2: 1425})
Epoch : 4
Epoch # 4
Start train
End train
Training loss: 0.04634438545882669, Training accuracy: 0.9840873653801989 
Start test
Average test loss(weighted):  10.5106, test accuracy:  38.6992
Class-wise accuracies:
 [0.27042531967163086, 0.3273622989654541, 0.8539057970046997, 0.0, 0.14811517298221588, 0.0, 0.8788501024246216, 0.24036410450935364, 0.3869923949241638]
Class-wise F1 scores:
 [0.3966534435749054, 0.1811199188232422, 0.25367581844329834, 0.0, 0.21407121419906616, 0.0, 0.5930835008621216, 0.3360508978366852, 0.3869923949241638]
Class-wise AUCs:
 [0.8022549748420715, 0.7154012322425842, 0.9074933528900146, 0.487931489944458, 0.6874979138374329, 0.5620832443237305, 0.867468535900116, 0.7633264064788818, 0.7629183530807495]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 54736/58783  93.11535648061515%
Noisy Selection success: 28907/106683  27.09616339997938%
Counts of filtered labels
Counter({0: 39361, 7: 18105, 3: 14867, 6: 10648, 4: 10066, 5: 7428, 1: 4663, 2: 1545})
Epoch : 5
Epoch # 5
Start train
End train
Training loss: 0.046875683952755695, Training accuracy: 0.9844318470259751 
Start test
Average test loss(weighted):  8.1928, test accuracy:  43.1916
Class-wise accuracies:
 [0.3960435092449188, 0.33273622393608093, 0.8050089478492737, 0.0, 0.1893737018108368, 0.0, 0.8617087602615356, 0.289005845785141, 0.4319162368774414]
Class-wise F1 scores:
 [0.5130482912063599, 0.188530832529068, 0.29145076870918274, 0.0, 0.25222375988960266, 0.0, 0.6094781160354614, 0.38105952739715576, 0.4319162368774414]
Class-wise AUCs:
 [0.8092797994613647, 0.7230290174484253, 0.9149690866470337, 0.6322413682937622, 0.7429600954055786, 0.6148124933242798, 0.8725899457931519, 0.7788012623786926, 0.7891552448272705]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 61622/65647  93.8687221045897%
Noisy Selection success: 28929/99819  28.981456436149433%
Counts of filtered labels
Counter({0: 33955, 7: 17184, 3: 14845, 6: 10615, 4: 9568, 5: 7429, 1: 4549, 2: 1674})
Epoch : 6
Epoch # 6
Start train
End train
Training loss: 0.04045685213380612, Training accuracy: 0.9861723858677915 
Start test
Average test loss(weighted):  8.3246, test accuracy:  46.1273
Class-wise accuracies:
 [0.4807780981063843, 0.35333630442619324, 0.8312462568283081, 0.0, 0.17809438705444336, 0.0, 0.8264440894126892, 0.35243919491767883, 0.4612732529640198]
Class-wise F1 scores:
 [0.5787885785102844, 0.2179557979106903, 0.2831319272518158, 0.0, 0.24286581575870514, 0.0, 0.6315538287162781, 0.4340134859085083, 0.4612732529640198]
Class-wise AUCs:
 [0.827094316482544, 0.7431459426879883, 0.9196550846099854, 0.5975807905197144, 0.736224889755249, 0.5947070121765137, 0.8746391534805298, 0.8020638823509216, 0.7952870726585388]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 66485/70564  94.21943200498838%
Noisy Selection success: 28875/94902  30.42612379085794%
Counts of filtered labels
Counter({0: 30241, 7: 16073, 3: 14824, 6: 10848, 4: 9518, 5: 7422, 1: 4415, 2: 1561})
Epoch : 7
Epoch # 7
Start train
End train
Training loss: 0.029309446527910753, Training accuracy: 0.9899495968960391 
Start test
Average test loss(weighted):  7.9290, test accuracy:  49.5749
Class-wise accuracies:
 [0.598087728023529, 0.29467085003852844, 0.8240906596183777, 0.0, 0.21490056812763214, 0.0, 0.807874321937561, 0.3635329306125641, 0.49574872851371765]
Class-wise F1 scores:
 [0.6497833132743835, 0.23329196870326996, 0.295362263917923, 0.0, 0.2731044888496399, 0.0, 0.6404557824134827, 0.44529616832733154, 0.49574872851371765]
Class-wise AUCs:
 [0.846839189529419, 0.7565938234329224, 0.9197733402252197, 0.6118046045303345, 0.7667464017868042, 0.600430965423584, 0.8766894340515137, 0.8132283091545105, 0.808171272277832]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 71936/76007  94.64391437630745%
Noisy Selection success: 28883/89459  32.28629875138331%
Counts of filtered labels
Counter({0: 25390, 7: 15673, 3: 14821, 6: 10969, 4: 9189, 5: 7408, 1: 4441, 2: 1568})
Epoch : 8
Epoch # 8
Start train
End train
Training loss: 0.02455916828353445, Training accuracy: 0.991122043199207 
Start test
Average test loss(weighted):  7.7243, test accuracy:  51.0829
Class-wise accuracies:
 [0.6428618431091309, 0.27362293004989624, 0.7734048962593079, 0.0, 0.24577026069164276, 0.0, 0.8195697069168091, 0.35371923446655273, 0.5108290910720825]
Class-wise F1 scores:
 [0.6700343489646912, 0.24812182784080505, 0.31159159541130066, 0.0, 0.2956086993217468, 0.0, 0.6383866667747498, 0.4423692524433136, 0.5108290910720825]
Class-wise AUCs:
 [0.8517699837684631, 0.7638773322105408, 0.9195711612701416, 0.6410811543464661, 0.782187819480896, 0.6305632591247559, 0.8775337338447571, 0.8168379068374634, 0.8160558938980103]
End test
Current sieving threshold is 0.0
Start eval
End eval
/u/home/tei/Data/confes-reihaneh/main.py:140: UserWarning: you are shuffling a 'Tensor' object which is not a subclass of 'Sequence'; `shuffle` is not guaranteed to behave correctly. E.g., non-numpy array/tensor objects with view semantics may contain duplicates after shuffling.
  np.random.shuffle(clean_labels_epoch)
Clean Selection success: 74637/78763  94.76149968894025%
Noisy Selection success: 28828/86703  33.24913786143501%
Counts of filtered labels
Counter({0: 23373, 7: 15461, 3: 14793, 6: 10716, 4: 8885, 5: 7401, 1: 4477, 2: 1597})
Epoch : 9
Epoch # 9
Start train
End train
Training loss: 0.02180470476019371, Training accuracy: 0.9924999697823118 
Start test
Average test loss(weighted):  7.6288, test accuracy:  51.9395
Class-wise accuracies:
 [0.6737223863601685, 0.2704881429672241, 0.7579010128974915, 0.0, 0.26120510697364807, 0.0, 0.8063565492630005, 0.36310625076293945, 0.519395112991333]
Class-wise F1 scores:
 [0.6775872707366943, 0.2520868182182312, 0.32460734248161316, 0.0, 0.3055555522441864, 0.0, 0.6435340046882629, 0.4500264525413513, 0.519395112991333]
Class-wise AUCs:
 [0.8532509803771973, 0.7673525810241699, 0.9210156798362732, 0.6613378524780273, 0.7931249141693115, 0.6463658213615417, 0.8775663375854492, 0.819218635559082, 0.8205093741416931]
End test
